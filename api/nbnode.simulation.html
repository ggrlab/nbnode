<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>nbnode.simulation package &#8212; nbnode 1.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=233b9934" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=def9ab29"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="nbnode.specific_analyses package" href="nbnode.specific_analyses.html" />
    <link rel="prev" title="nbnode.plot package" href="nbnode.plot.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="nbnode-simulation-package">
<h1>nbnode.simulation package<a class="headerlink" href="#nbnode-simulation-package" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-nbnode.simulation.FlowSimulationTree">
<span id="nbnode-simulation-flowsimulationtree-module"></span><h2>nbnode.simulation.FlowSimulationTree module<a class="headerlink" href="#module-nbnode.simulation.FlowSimulationTree" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nbnode.simulation.FlowSimulationTree.</span></span><span class="sig-name descname"><span class="pre">BaseFlowSimulationTree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rootnode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="nbnode.html#nbnode.nbnode.NBNode" title="nbnode.nbnode.NBNode"><span class="pre">NBNode</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_cellgroup_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sample_name'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_percentages</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.1.4)"><span class="pre">DataFrame</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/constants.html#None" title="(in Python v3.8)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">12987</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.List" title="(in Python v3.8)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'dataset_melanoma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#bool" title="(in Python v3.8)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nbnode/simulation/FlowSimulationTree.html#BaseFlowSimulationTree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.8/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class for flow simulation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree.estimate_cell_distributions">
<span class="sig-name descname"><span class="pre">estimate_cell_distributions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.List" title="(in Python v3.8)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="nbnode.html#nbnode.nbnode.NBNode" title="nbnode.nbnode.NBNode"><span class="pre">NBNode</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Dict" title="(in Python v3.8)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Dict" title="(in Python v3.8)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Literal" title="(in Python v3.8)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'mu'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'cov'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.1.4)"><span class="pre">DataFrame</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/nbnode/simulation/FlowSimulationTree.html#BaseFlowSimulationTree.estimate_cell_distributions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree.estimate_cell_distributions" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the distribution of cells in each node.</p>
<blockquote>
<div><p>If no distribution can be estimated (less than 2 cells),
the node is removed from the simulation.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nodes</strong> (<em>List</em><em>[</em><a class="reference internal" href="nbnode.html#nbnode.nbnode.NBNode" title="nbnode.nbnode.NBNode"><em>NBNode</em></a><em>]</em>) – A list of nodes whose distribution should be estimated.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A dictionary of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;node_name&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;mu&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>  <span class="c1"># mean of the distribution</span>
        <span class="s2">&quot;cov&quot;</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>  <span class="c1"># covariance of the distribution</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The mean and covariance matrix are calculated for the features
given in <cite>self.include_features</cite>.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)">str</a>, Dict[Literal[“mu”, “cov”], pd.DataFrame]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree.estimate_population_distribution">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">estimate_population_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_percentages</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Dict" title="(in Python v3.8)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Literal" title="(in Python v3.8)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'__name'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Any" title="(in Python v3.8)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/nbnode/simulation/FlowSimulationTree.html#BaseFlowSimulationTree.estimate_population_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree.estimate_population_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the distribution of populations.</p>
<blockquote>
<div><p>The distribution is estimated from the given node percentages.
The distribution parameters are usually pd.DataFrames.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>node_percentages</strong> (<em>_type_</em>) – A DataFrame with the samples as columns and the populations as rows.
The values are the percentage of cells in the population.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dict[str, Any]:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="c1"># __name must be given</span>
    <span class="s2">&quot;__name&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">population_means</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
    <span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="n">population_means</span><span class="p">,</span>   <span class="c1"># distribution parameter</span>
    <span class="s2">&quot;cov&quot;</span><span class="p">:</span> <span class="n">population_cov</span><span class="p">,</span>      <span class="c1"># distribution parameter</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate mean and covariance for each of the populations</span>
<span class="c1"># (rows of node_percentages)</span>

<span class="n">population_means</span> <span class="o">=</span> <span class="n">node_percentages</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">if</span> <span class="n">node_percentages</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">population_cov</span> <span class="o">=</span> <span class="n">node_percentages</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">cov</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">population_cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">population_means</span><span class="p">))</span>
    <span class="n">population_cov</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">population_cov</span><span class="p">,</span>
        <span class="n">columns</span><span class="o">=</span><span class="n">population_means</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="n">population_means</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
    <span class="p">)</span>
<span class="k">return</span> <span class="p">{</span>
    <span class="s2">&quot;__name&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">population_means</span><span class="o">.</span><span class="n">index</span><span class="p">),</span>
    <span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="n">population_means</span><span class="p">,</span>
    <span class="s2">&quot;cov&quot;</span><span class="p">:</span> <span class="n">population_cov</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree.generate_populations">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">generate_populations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population_parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Dict" title="(in Python v3.8)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Any" title="(in Python v3.8)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cells</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.List" title="(in Python v3.8)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#float" title="(in Python v3.8)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/nbnode/simulation/FlowSimulationTree.html#BaseFlowSimulationTree.generate_populations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree.generate_populations" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a list of percentages per cell population.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>population_parameters</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – Parameters for the distribution to draw from.</p></li>
<li><p><strong>n_cells</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – How many cells should be drawn per sample</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of percentages per cell population</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)">int</a>]</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Generate random percentages for each population</span>
<span class="n">random_mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span>
    <span class="o">**</span><span class="n">population_parameters</span>
<span class="p">)</span>
<span class="c1"># HACK: therefore all values are positive, this is a kindoff hack and</span>
<span class="c1"># should be replaced with a better distribution</span>
<span class="n">random_mean</span> <span class="o">-=</span> <span class="nb">min</span><span class="p">(</span><span class="n">random_mean</span><span class="p">)</span>
<span class="c1"># add the smallest value such that the &quot;most negative population&quot; has</span>
<span class="c1"># atleast _some_ chance of occuring</span>
<span class="n">random_mean</span> <span class="o">+=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">random_mean</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e3</span>
<span class="c1"># normalize to 1</span>
<span class="n">random_mean</span> <span class="o">=</span> <span class="n">random_mean</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">random_mean</span><span class="p">)</span>

<span class="c1"># 2. &quot;Sample&quot; the number of cells according to the random percentages</span>
<span class="n">onesample_ncells_perpop</span> <span class="o">=</span> <span class="n">random_mean</span> <span class="o">*</span> <span class="n">n_cells</span>
<span class="n">onesample_ncells_perpop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">onesample_ncells_perpop</span><span class="p">)</span>

<span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">onesample_ncells_perpop</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n_cells</span><span class="p">:</span>
    <span class="c1"># because of floor there are too little cells sampled</span>
    <span class="n">remaining_cells</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
        <span class="p">[</span><span class="n">population_i</span> <span class="k">for</span> <span class="n">population_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">random_mean</span><span class="p">))],</span>
        <span class="n">size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">n_cells</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">onesample_ncells_perpop</span><span class="p">)),</span>
        <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="n">random_mean</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">cell_from_pop_i</span> <span class="ow">in</span> <span class="n">remaining_cells</span><span class="p">:</span>
        <span class="n">onesample_ncells_perpop</span><span class="p">[</span><span class="n">cell_from_pop_i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="k">return</span> <span class="n">onesample_ncells_perpop</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree.ncells_from_percentages">
<span class="sig-name descname"><span class="pre">ncells_from_percentages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">percentages</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.1.4)"><span class="pre">DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cells</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.List" title="(in Python v3.8)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/nbnode/simulation/FlowSimulationTree.html#BaseFlowSimulationTree.ncells_from_percentages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree.ncells_from_percentages" title="Permalink to this definition">¶</a></dt>
<dd><p>‘Sample’ the number of cells according to the random percentages</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>percentages</strong> (<em>pd.DataFrame</em>) – A DataFrame with the sample percentages as columns and the
populations as rows.</p></li>
<li><p><strong>n_cells</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The total number of cells to be sampled.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list with the number of cells per population. The sum of the
list is equal to <cite>n_cells</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)">int</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree.remove_population">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">remove_population</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nbnode/simulation/FlowSimulationTree.html#BaseFlowSimulationTree.remove_population"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree.remove_population" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a certain population from the simulation. Necessary if any population
had no cells and therefore the cell-parameters for the population cannot
be estimated. ALWAYS call
<cite>self.population_parameters[“__name”].remove(population_name)</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>population_name</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The name of the population which should be removed from the
population_parameters.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">population_parameters</span><span class="p">[</span><span class="s2">&quot;__name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">population_name</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">population_parameters</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
    <span class="n">population_name</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">population_parameters</span><span class="p">[</span><span class="s2">&quot;cov&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
    <span class="n">population_name</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">population_parameters</span><span class="p">[</span><span class="s2">&quot;cov&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
    <span class="n">population_name</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree.reset_populations">
<span class="sig-name descname"><span class="pre">reset_populations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nbnode/simulation/FlowSimulationTree.html#BaseFlowSimulationTree.reset_populations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree.reset_populations" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the population parameters to the initially estimated values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_cells</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sampled_cell_numbers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#bool" title="(in Python v3.8)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_only_diagonal_covmat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#bool" title="(in Python v3.8)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">population_parameters</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Tuple" title="(in Python v3.8)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.1.4)"><span class="pre">DataFrame</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.1.4)"><span class="pre">Series</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.1.4)"><span class="pre">DataFrame</span></a></span></span><a class="reference internal" href="../_modules/nbnode/simulation/FlowSimulationTree.html#BaseFlowSimulationTree.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample cells from the tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_cells</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Number of cells to sample from the tree. Defaults to 10000.</p></li>
<li><p><strong>return_sampled_cell_numbers</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to return the number of cells sampled per population
as well as the sampled cells themselves.
Defaults to False.</p></li>
<li><p><strong>use_only_diagonal_covmat</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to use only the diagonal of the covariance matrix
when sampling cells.
Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If <cite>return_sampled_cell_numbers</cite> is True, a tuple with the
sampled cells and the number of cells sampled per population
is returned. Otherwise, only the sampled cells are returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[Tuple[pd.DataFrame, pd.Series], pd.DataFrame]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree.sample_populations">
<span class="sig-name descname"><span class="pre">sample_populations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_cells</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">population_parameters</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.1.4)"><span class="pre">Series</span></a></span></span><a class="reference internal" href="../_modules/nbnode/simulation/FlowSimulationTree.html#BaseFlowSimulationTree.sample_populations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree.sample_populations" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate number of cells according to leaf node population distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_cells</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Number of cells to sample. Defaults to 10000.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas Series with the number of cells per population.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree.set_seed">
<span class="sig-name descname"><span class="pre">set_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nbnode/simulation/FlowSimulationTree.html#BaseFlowSimulationTree.set_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree.set_seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the seed for the random number generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The seed for the random number generator.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nbnode.simulation.FlowSimulationTree.</span></span><span class="sig-name descname"><span class="pre">FlowSimulationTreeDirichlet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rootnode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="nbnode.html#nbnode.nbnode.NBNode" title="nbnode.nbnode.NBNode"><span class="pre">NBNode</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_cellgroup_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sample_name'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_percentages</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.1.4)"><span class="pre">DataFrame</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/constants.html#None" title="(in Python v3.8)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">12987</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dataset_melanoma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#bool" title="(in Python v3.8)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nbnode/simulation/FlowSimulationTree.html#FlowSimulationTreeDirichlet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree" title="nbnode.simulation.FlowSimulationTree.BaseFlowSimulationTree"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseFlowSimulationTree</span></code></a></p>
<p>Simulate a tree of cell populations using the Dirichlet distribution.</p>
<dl class="py property">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.alpha_all">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">alpha_all</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.1.4)"><span class="pre">Series</span></a></em><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.alpha_all" title="Permalink to this definition">¶</a></dt>
<dd><p>The alpha parameter of the Dirichlet distribution for all populations</p>
<p>Concentration parameters “alpha” of the Dirichlet distribution.
The alpha parameter is a vector of positive values, where each value
corresponds to a population. The larger the value, the more cells
will be generated for that population.</p>
<p><code class="docutils literal notranslate"><span class="pre">alpha_all</span></code> are the concentration parameters for all, including the
intermediate populations.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A series (named) of alpha parameters per cell population
(including intermediate populations).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.estimate_population_distribution">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">estimate_population_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_percentages</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nbnode/simulation/FlowSimulationTree.html#FlowSimulationTreeDirichlet.estimate_population_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.estimate_population_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the population distribution using the Dirichlet distribution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.generate_populations">
<span class="sig-name descname"><span class="pre">generate_populations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population_parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cells</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.1.4)"><span class="pre">DataFrame</span></a></span></span><a class="reference internal" href="../_modules/nbnode/simulation/FlowSimulationTree.html#FlowSimulationTreeDirichlet.generate_populations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.generate_populations" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a population of cells using the Dirichlet distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>population_parameters</strong> (<em>_type_</em>) – <p>Given as a dictionary with keys:</p>
<blockquote>
<div><ul>
<li><p>alpha: The alpha parameter of the Dirichlet distribution</p></li>
<li><p>__name: The name of the population</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>n_cells</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of cells to generate</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dataframe with the generated cells per population</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.mean_leafs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean_leafs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.1.4)"><span class="pre">Series</span></a></em><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.mean_leafs" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean from dirichlet distribution</p>
<p>Estimating a Dirichlet distribution
Thomas P. Minka
2000 (revised 2003, 2009, 2012)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A series (named) of means per cell population</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.new_pop_mean">
<span class="sig-name descname"><span class="pre">new_pop_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population_node_full_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#float" title="(in Python v3.8)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nbnode/simulation/FlowSimulationTree.html#FlowSimulationTreeDirichlet.new_pop_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.new_pop_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the new mean of the Dirichlet distribution for a given population</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>population_node_full_name</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The get_name_full() of a population or the node itself.</p></li>
<li><p><strong>percentage</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The new percentage of cells that should be generated for the
given population. Must be between 0 and 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.pop_alpha">
<span class="sig-name descname"><span class="pre">pop_alpha</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population_node_full_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#float" title="(in Python v3.8)"><span class="pre">float</span></a></span></span><a class="reference internal" href="../_modules/nbnode/simulation/FlowSimulationTree.html#FlowSimulationTreeDirichlet.pop_alpha"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.pop_alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the alpha parameter of the Dirichlet distribution for a given population</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>population_node_full_name</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The get_name_full() of a population or the node itself.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The alpha parameter of the Dirichlet distribution for the given
population.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#float" title="(in Python v3.8)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.pop_leafnode_names">
<span class="sig-name descname"><span class="pre">pop_leafnode_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population_node_full_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="nbnode.html#nbnode.nbnode.NBNode" title="nbnode.nbnode.NBNode"><span class="pre">NBNode</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.List" title="(in Python v3.8)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/nbnode/simulation/FlowSimulationTree.html#FlowSimulationTreeDirichlet.pop_leafnode_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.pop_leafnode_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the names of the leaf nodes of any intermediate population</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>population_node_full_name</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><a class="reference internal" href="nbnode.html#nbnode.nbnode.NBNode" title="nbnode.nbnode.NBNode"><em>NBNode</em></a><em>]</em>) – The get_name_full() of a population, or the node itself.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of the get_name_full() of the leaf nodes below the given
population.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)">str</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.pop_mean">
<span class="sig-name descname"><span class="pre">pop_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population_node_full_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nbnode/simulation/FlowSimulationTree.html#FlowSimulationTreeDirichlet.pop_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.pop_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the mean of the Dirichlet distribution for a given population</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.precision">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">precision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#float" title="(in Python v3.8)"><span class="pre">float</span></a></em><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.precision" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean from dirichlet distribution</p>
<p>Estimating a Dirichlet distribution
Thomas P. Minka
2000 (revised 2003, 2009, 2012)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Total precision of all populations</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#float" title="(in Python v3.8)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.remove_population">
<span class="sig-name descname"><span class="pre">remove_population</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nbnode/simulation/FlowSimulationTree.html#FlowSimulationTreeDirichlet.remove_population"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet.remove_population" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a population from the tree</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>population_name</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The get_name_full() of a population</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-nbnode.simulation.TreeMeanDistributionSampler">
<span id="nbnode-simulation-treemeandistributionsampler-module"></span><h2>nbnode.simulation.TreeMeanDistributionSampler module<a class="headerlink" href="#module-nbnode.simulation.TreeMeanDistributionSampler" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="nbnode.simulation.TreeMeanDistributionSampler.PseudoTorchDistributionNormal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nbnode.simulation.TreeMeanDistributionSampler.</span></span><span class="sig-name descname"><span class="pre">PseudoTorchDistributionNormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#float" title="(in Python v3.8)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#float" title="(in Python v3.8)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nbnode/simulation/TreeMeanDistributionSampler.html#PseudoTorchDistributionNormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.TreeMeanDistributionSampler.PseudoTorchDistributionNormal" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.8/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class that mimics the torch.distributions.Distribution class.</p>
<p>This class is used as a fallback if torch is not installed. It is used
within TreeMeanDistributionSampler to sample a new mean for a population
that is to be changed.</p>
<p>So the calls are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mean_distribution</span> <span class="o">=</span> <span class="n">PseudoTorchDistributionNormal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">new_mean</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">new_value_from_distribution</span> <span class="o">=</span> <span class="n">mean_distribution</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.TreeMeanDistributionSampler.PseudoTorchDistributionNormal.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#float" title="(in Python v3.8)"><span class="pre">float</span></a></span></span><a class="reference internal" href="../_modules/nbnode/simulation/TreeMeanDistributionSampler.html#PseudoTorchDistributionNormal.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.TreeMeanDistributionSampler.PseudoTorchDistributionNormal.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample a value from a normal distribution with the given parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A value from a normal distribution with the given parameters.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#float" title="(in Python v3.8)">float</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nbnode.simulation.TreeMeanDistributionSampler.TreeMeanDistributionSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nbnode.simulation.TreeMeanDistributionSampler.</span></span><span class="sig-name descname"><span class="pre">TreeMeanDistributionSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flowsim_tree:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">~nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">population_name_to_change:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_distribution=&lt;function</span> <span class="pre">mean_dist_fun&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples=100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cells=10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_only_diagonal_covmat=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed_sample_0=129873</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir='sim/sim00_m0.sd1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_return_sampled_cell_numbers=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_changed_parameters=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_target_mean_proportion=1e-09</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nbnode/simulation/TreeMeanDistributionSampler.html#TreeMeanDistributionSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.TreeMeanDistributionSampler.TreeMeanDistributionSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.8/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class synthesizing cytometry samples with a
distribution for the mean of a population.</p>
<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.TreeMeanDistributionSampler.TreeMeanDistributionSampler.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nbnode/simulation/TreeMeanDistributionSampler.html#TreeMeanDistributionSampler.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.TreeMeanDistributionSampler.TreeMeanDistributionSampler.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Synthesize cytometry samples with a
distribution for the mean of a population.</p>
<p>See the __init__ method for the description of the arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>A dataframe with the sampled cell numbers.</p></li>
<li><p>A dictionary with the parameters of the dirichlet distribution.</p></li>
<li><p>A list of dataframes with the sampled cell matrices
(n_cells X features) for each sample.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[pd.DataFrame, Dict[<a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)">str</a>, Any], List[pd.DataFrame]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="nbnode.simulation.TreeMeanDistributionSampler.mean_dist_fun">
<span class="sig-prename descclassname"><span class="pre">nbnode.simulation.TreeMeanDistributionSampler.</span></span><span class="sig-name descname"><span class="pre">mean_dist_fun</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_mean</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#float" title="(in Python v3.8)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#nbnode.simulation.TreeMeanDistributionSampler.PseudoTorchDistributionNormal" title="nbnode.simulation.TreeMeanDistributionSampler.PseudoTorchDistributionNormal"><span class="pre">PseudoTorchDistributionNormal</span></a></span></span><a class="reference internal" href="../_modules/nbnode/simulation/TreeMeanDistributionSampler.html#mean_dist_fun"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.TreeMeanDistributionSampler.mean_dist_fun" title="Permalink to this definition">¶</a></dt>
<dd><p>A function that returns a distribution for the new mean.</p>
<p>This is a fallback function that is used if torch is not installed.
Within TreeMeanDistributionSampler, this function is used to sample a
distribution for the new mean. The distribution is then used to sample
a new mean for the population that is to be changed.</p>
<p>So the calls are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mean_distribution</span> <span class="o">=</span> <span class="n">mean_dist_fun</span><span class="p">(</span><span class="n">new_mean</span><span class="p">)</span>
<span class="n">new_value_from_distribution</span> <span class="o">=</span> <span class="n">mean_distribution</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>original_mean</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The mean of the normal distribution</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mimics the torch.distributions.Distribution class in the sense that
it has a sample() method that returns a new value from the distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pseudo-D.Distribution</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-nbnode.simulation.TreeMeanRelative">
<span id="nbnode-simulation-treemeanrelative-module"></span><h2>nbnode.simulation.TreeMeanRelative module<a class="headerlink" href="#module-nbnode.simulation.TreeMeanRelative" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="nbnode.simulation.TreeMeanRelative.TreeMeanRelative">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nbnode.simulation.TreeMeanRelative.</span></span><span class="sig-name descname"><span class="pre">TreeMeanRelative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flowsim_tree</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet" title="nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet"><span class="pre">FlowSimulationTreeDirichlet</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_pop_mean_proportional</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Dict" title="(in Python v3.8)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#float" title="(in Python v3.8)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cells</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_only_diagonal_covmat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed_sample_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">129873</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sim/sim00_pure_estimate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_return_sampled_cell_numbers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_changed_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nbnode/simulation/TreeMeanRelative.html#TreeMeanRelative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.TreeMeanRelative.TreeMeanRelative" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.8/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Sample from a tree with a relative change in a population.</p>
<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.TreeMeanRelative.TreeMeanRelative.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Tuple" title="(in Python v3.8)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.1.4)"><span class="pre">DataFrame</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Dict" title="(in Python v3.8)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Any" title="(in Python v3.8)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.List" title="(in Python v3.8)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.1.4)"><span class="pre">DataFrame</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/nbnode/simulation/TreeMeanRelative.html#TreeMeanRelative.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.TreeMeanRelative.TreeMeanRelative.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>A method to sample with a relative change in a population mean.</p>
<p>See the __init__ method for the description of the arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>A dataframe with the sampled cell numbers.</p></li>
<li><p>A dictionary with the parameters of the
dirichlet distribution.</p></li>
<li><p>A list of dataframes with the sampled cell matrices
(n_cells X features) for each sample.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[pd.DataFrame, Dict[<a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)">str</a>, Any], List[pd.DataFrame]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nbnode.simulation.TreeMeanRelative.TreeMeanRelative.sample_customize">
<span class="sig-name descname"><span class="pre">sample_customize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cells</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_pop_mean_proportional</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_only_diagonal_covmat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed_sample_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_only_return_sampled_cell_numbers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_changed_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Tuple" title="(in Python v3.8)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.1.4)"><span class="pre">DataFrame</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Dict" title="(in Python v3.8)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Any" title="(in Python v3.8)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.List" title="(in Python v3.8)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.1.4)"><span class="pre">DataFrame</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/nbnode/simulation/TreeMeanRelative.html#TreeMeanRelative.sample_customize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.TreeMeanRelative.TreeMeanRelative.sample_customize" title="Permalink to this definition">¶</a></dt>
<dd><p>A customizable method to sample with a relative change in a population mean.</p>
<p>See the __init__ method for the description of the arguments.
In contrast to <code class="docutils literal notranslate"><span class="pre">.sample()</span></code>, this method allows to change each parameter
individually.
If any argument is not given, the default value set in __init__ method
will be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>A dataframe with the sampled cell numbers.</p></li>
<li><p>A dictionary with the parameters of the
dirichlet distribution.</p></li>
<li><p>A list of dataframes with the sampled cell matrices
(n_cells X features) for each sample.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[pd.DataFrame, Dict[<a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)">str</a>, Any], List[pd.DataFrame]]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-nbnode.simulation.sim_proportional">
<span id="nbnode-simulation-sim-proportional-module"></span><h2>nbnode.simulation.sim_proportional module<a class="headerlink" href="#module-nbnode.simulation.sim_proportional" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="nbnode.simulation.sim_proportional.sim_proportional">
<span class="sig-prename descclassname"><span class="pre">nbnode.simulation.sim_proportional.</span></span><span class="sig-name descname"><span class="pre">sim_proportional</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flowsim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet" title="nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet"><span class="pre">FlowSimulationTreeDirichlet</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cells</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_only_diagonal_covmat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_pop_mean_proportional</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'/AllCells/CD4+/CD8-/Tem':</span> <span class="pre">1}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sim/intraassay/sim00_baseline'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed_sample_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">129873</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_return_sampled_cell_numbers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Tuple" title="(in Python v3.8)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.1.4)"><span class="pre">DataFrame</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Dict" title="(in Python v3.8)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Any" title="(in Python v3.8)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.List" title="(in Python v3.8)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.1.4)"><span class="pre">DataFrame</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/nbnode/simulation/sim_proportional.html#sim_proportional"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.sim_proportional.sim_proportional" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function simulates new cells (<cite>n_cells</cite>) for <cite>n_samples</cite> samples
according to the given flow simulation <cite>flowsim</cite>.</p>
<blockquote>
<div><p>1. The population mean of the keys from <cite>change_pop_mean_proportional</cite> are
multiplied with their respective value and changed by
<cite>flowsim.new_pop_mean(old_mean * change_prop)</cite>
2. Generate <cite>n_samples</cite> with <cite>n_cells</cite> are sampled from the changed
FlowSimulation.
3. (optional) The generated samples are saved to save_dir
3. The actual number of cells and the changed parameters are returned</p>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – <p>The number of simulated samples of n_cells.</p>
<p>Defaults to 100.</p>
</p></li>
<li><p><strong>n_cells</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – <p>The number of cells per sample.</p>
<p>Defaults to 25000.</p>
</p></li>
<li><p><strong>use_only_diagonal_covmat</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – <p>If False, the complete covariance matrix per cell population is used to
draw new cells
If True, all off-diagonal elements of the covariance matrix are set to 0.</p>
<p>Defaults to True.</p>
</p></li>
<li><p><strong>change_pop_mean_proportional</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a><em>, </em><em>optional</em>) – <p>A dictionary of which cell population(s) should be changed by which
fraction.
A value of 1 does not change the mean proportion of the cell population.
The changes to <cite>flowsim</cite> are not persistent as they are undone after the
simulation.</p>
<p>Defaults to {“/AllCells/CD4+/CD8-/Tem”: 1}.</p>
</p></li>
<li><p><strong>save_dir</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – <p>If given, the created samples (n cells X p markers) are saved into that
directory as f”sample_{sample_i}.csv”.</p>
<p>Defaults to “sim/intraassay/sim00_baseline”.</p>
</p></li>
<li><p><strong>seed_sample_0</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – flowsim.set_seed(seed_sample_0 + sample_i)</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – Verboseness. Defaults to True.</p></li>
<li><p><strong>only_return_sampled_cell_numbers</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – If true, only the number of cells per population are returned,
not the actual samples.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>pd.DataFrame:</dt><dd><p>Returns the true number of generated cells per leaf-population.</p>
</dd>
<dt>Dict:</dt><dd><p>A deep copy of <cite>flowsim.population_parameters</cite></p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-nbnode.simulation.sim_target">
<span id="nbnode-simulation-sim-target-module"></span><h2>nbnode.simulation.sim_target module<a class="headerlink" href="#module-nbnode.simulation.sim_target" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="nbnode.simulation.sim_target.sim_target">
<span class="sig-prename descclassname"><span class="pre">nbnode.simulation.sim_target.</span></span><span class="sig-name descname"><span class="pre">sim_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flowsim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet" title="nbnode.simulation.FlowSimulationTree.FlowSimulationTreeDirichlet"><span class="pre">FlowSimulationTreeDirichlet</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_pop_mean_target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.List" title="(in Python v3.8)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Dict" title="(in Python v3.8)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#float" title="(in Python v3.8)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[{'/AllCells/CD4+/CD8-/Tem':</span> <span class="pre">0.05}]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cells</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_only_diagonal_covmat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sim/intraassay/sim00_target'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed_sample_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">129873</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_return_sampled_cell_numbers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_changed_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Tuple" title="(in Python v3.8)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.1.4)"><span class="pre">DataFrame</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Dict" title="(in Python v3.8)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.Any" title="(in Python v3.8)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.8/library/typing.html#typing.List" title="(in Python v3.8)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.1.4)"><span class="pre">DataFrame</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/nbnode/simulation/sim_target.html#sim_target"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nbnode.simulation.sim_target.sim_target" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This function simulates new cells (<cite>n_cells</cite>) for <cite>n_samples</cite> samples according
to the given flow simulation <cite>flowsim</cite>.</p>
<ol class="arabic simple">
<li><p>flowsim.reset_populations() (for consistency)</p></li>
<li><p>For every list element in change_pop_mean_target,
change all contained populations (keys) to their respective
mean proportions (values). Values outside (0, 1) are not allowed.</p></li>
<li><p>For every sample: flowsim.simulate_cells(n_cells).</p></li>
<li><p>Return the true number of generated cells per leaf-population,
a deep copy of <cite>flowsim.population_parameters</cite> and the
generated samples. If <cite>save_dir</cite> is given, the samples are also saved.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – <p>The number of simulated samples of n_cells.</p>
<p>Defaults to 100.</p>
</p></li>
<li><p><strong>n_cells</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – <p>The number of cells per sample.</p>
<p>Defaults to 25000.</p>
</p></li>
<li><p><strong>use_only_diagonal_covmat</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – <p>If False, the complete covariance matrix per cell population is used to
draw new cells
If True, all off-diagonal elements of the covariance matrix are set to 0.</p>
<p>Defaults to True.</p>
</p></li>
<li><p><strong>change_pop_mean_target</strong> (<em>List</em><em>[</em><em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3.8/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>]</em><em>]</em>) – A dictionary of which cell population(s) should be changed to which mean
proportion of all cells. floats should be between (0, 1)</p></li>
<li><p><strong>save_dir</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – <p>If given, the created samples (n cells X p markers) are saved into that
directory as f”sample_{sample_i}.csv”.</p>
<p>Defaults to “sim/intraassay/sim00_target”.</p>
</p></li>
<li><p><strong>seed_sample_0</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – flowsim.set_seed(seed_sample_0 + sample_i)</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – Verboseness. Defaults to True.</p></li>
<li><p><strong>only_return_sampled_cell_numbers</strong> (<a class="reference external" href="https://docs.python.org/3.8/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – If true, only the number of cells per population are returned,
not the actual samples.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>pd.DataFrame:</dt><dd><p>The true number of generated cells per leaf-population.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Dict:</dt><dd><p>A deep copy of <cite>flowsim.population_parameters</cite>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>List[pd.DataFrame]:</dt><dd><p>The generated samples (n cells X p markers), potentially also saved
into the given save_dir as f”sample_{sample_i}.csv”.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">simulated_cell_populations</span><span class="p">,</span> <span class="n">changed_parameters</span><span class="p">,</span> <span class="n">simulated_samples</span> <span class="o">=</span> <span class="n">sim_target</span><span class="p">(</span>
    <span class="n">flowsim</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-nbnode.simulation">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-nbnode.simulation" title="Permalink to this heading">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">nbnode</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../readme.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributions &amp; Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Module Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="nbnode.html">nbnode package</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="modules.html">nbnode</a><ul>
  <li><a href="nbnode.html">nbnode package</a><ul>
      <li>Previous: <a href="nbnode.plot.html" title="previous chapter">nbnode.plot package</a></li>
      <li>Next: <a href="nbnode.specific_analyses.html" title="next chapter">nbnode.specific_analyses package</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, gunthergl.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/api/nbnode.simulation.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>