<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Counting and math &#8212; nbnode 0.0.post1.dev1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=233b9934" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=e577996c"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Advanced predictions, data and plotting" href="nbnode-04.html" />
    <link rel="prev" title="Part predictions and unfitting data" href="nbnode-02.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Counting-and-math">
<h1>Counting and math<a class="headerlink" href="#Counting-and-math" title="Permalink to this heading">¶</a></h1>
<p>Apart from introducing non-binary trees, the power of NBNode comes from its included counting and math mechanisms. Each <code class="docutils literal notranslate"><span class="pre">NBNode</span></code> has a <code class="docutils literal notranslate"><span class="pre">math_node_attribute</span></code> which is used to calculate math on. This is usually set to <code class="docutils literal notranslate"><span class="pre">counter</span></code>.</p>
<p>In this example, we will use a small test dataset coming with the package. It comes from a flow cytometry experiment with 13 features (columns) of 999 cells (rows). Each cell can further be classified into cell types which we defined with prior biological knowledge as tree given in <code class="docutils literal notranslate"><span class="pre">nbtree</span></code>.</p>
<section id="Counting">
<h2>Counting<a class="headerlink" href="#Counting" title="Permalink to this heading">¶</a></h2>
<p>I start by introducing how to count.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="nb">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="n">cellmat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">pardir</span><span class="p">,</span>
        <span class="n">os</span><span class="o">.</span><span class="n">pardir</span><span class="p">,</span>
        <span class="s2">&quot;tests&quot;</span><span class="p">,</span>
        <span class="s2">&quot;testdata&quot;</span><span class="p">,</span>
        <span class="s2">&quot;flowcytometry&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gated_cells&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cellmat.csv&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="c1"># FS TOF (against FS INT which is &quot;FS&quot;)</span>
<span class="n">cellmat</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;FS_TOF&quot;</span><span class="p">:</span> <span class="s2">&quot;FS.0&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cellmat</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_.*&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">cellmat</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cellmat</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/home/gugl/clonedgit/ccc_verse/nbnode/docs/notebooks
         FS  FS.0      SS  CD45RA  CCR7  CD28   PD1  CD27   CD4   CD8   CD3
0    197657    94  186372    3.90  6.34  4.97 -1.98  7.51  5.87  3.55  5.83  \
1    180716    92  135447    6.48  6.63  5.17  3.07  7.38  5.49  2.64  5.83
2    134129    90  168268    5.92  6.53  5.39  2.60  7.57  5.70  2.54  5.74
3    239241    94   79262    5.47  6.57  4.68  3.30  7.36  5.75  2.76  6.06
4    246527    89   97635    6.12  6.26  5.22  3.05  7.40  5.70  2.66  6.29
..      ...   ...     ...     ...   ...   ...   ...   ...   ...   ...   ...
994  176236    90  149982    6.48 -1.11  2.85 -1.55  2.28  0.59  1.70  0.39
995  191863    99  115406    6.30  5.19  3.01  2.07 -1.58  0.62  1.02  0.73
996  217752    93  124675    6.35  4.75  0.42  1.89  2.02  0.52  1.48  0.53
997  334174    97  210458    1.90  1.36  1.22  2.52 -0.72  0.59  1.03  0.75
998  308089   103  219747    6.48 -0.42  1.23  2.64  7.07  0.57  1.82  1.72

     CD57  CD45
0    2.62  6.78
1    2.39  6.76
2    1.02  6.46
3    1.14  6.59
4    2.22  6.33
..    ...   ...
994  4.22  6.49
995  2.69  6.22
996  2.92  6.50
997  2.98  5.38
998  2.87  6.03

[999 rows x 13 columns]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nbnode.nbnode_trees</span> <span class="k">as</span> <span class="nn">nbtree</span>
<span class="n">cell_tree</span> <span class="o">=</span> <span class="n">nbtree</span><span class="o">.</span><span class="n">tree_complete_aligned_trunk</span><span class="p">()</span>
<span class="n">cell_tree</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">(</span><span class="s2">&quot;__long__&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type='text/css'>
.datatable table.frame { margin-bottom: 0; }
.datatable table.frame thead { border-bottom: none; }
.datatable table.frame tr.coltypes td {  color: #FFFFFF;  line-height: 6px;  padding: 0 0.5em;}
.datatable .bool    { background: #DDDD99; }
.datatable .object  { background: #565656; }
.datatable .int     { background: #5D9E5D; }
.datatable .float   { background: #4040CC; }
.datatable .str     { background: #CC4040; }
.datatable .time    { background: #40CC40; }
.datatable .row_index {  background: var(--jp-border-color3);  border-right: 1px solid var(--jp-border-color0);  color: var(--jp-ui-font-color3);  font-size: 9px;}
.datatable .frame tbody td { text-align: left; }
.datatable .frame tr.coltypes .row_index {  background: var(--jp-border-color0);}
.datatable th:nth-child(2) { padding-left: 12px; }
.datatable .hellipsis {  color: var(--jp-cell-editor-border-color);}
.datatable .vellipsis {  background: var(--jp-layout-color0);  color: var(--jp-cell-editor-border-color);}
.datatable .na {  color: var(--jp-cell-editor-border-color);  font-size: 80%;}
.datatable .sp {  opacity: 0.25;}
.datatable .footer { font-size: 9px; }
.datatable .frame_dimensions {  background: var(--jp-border-color3);  border-top: 1px solid var(--jp-border-color0);  color: var(--jp-ui-font-color3);  display: inline-block;  opacity: 0.6;  padding: 1px 10px 1px 5px;}
</style></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AllCells (counter:0, decision_name:None, decision_value:None)
├── DN (counter:0, decision_name:[&#39;CD4&#39;, &#39;CD8&#39;], decision_value:[-1, -1])
├── DP (counter:0, decision_name:[&#39;CD4&#39;, &#39;CD8&#39;], decision_value:[1, 1])
├── CD4-/CD8+ (counter:0, decision_name:[&#39;CD4&#39;, &#39;CD8&#39;], decision_value:[-1, 1])
│   ├── naive (counter:0, decision_name:[&#39;CCR7&#39;, &#39;CD45RA&#39;], decision_value:[1, 1])
│   ├── Tcm (counter:0, decision_name:[&#39;CCR7&#39;, &#39;CD45RA&#39;], decision_value:[1, -1])
│   ├── Temra (counter:0, decision_name:[&#39;CCR7&#39;, &#39;CD45RA&#39;], decision_value:[-1, 1])
│   └── Tem (counter:0, decision_name:[&#39;CCR7&#39;, &#39;CD45RA&#39;], decision_value:[-1, -1])
└── CD4+/CD8- (counter:0, decision_name:[&#39;CD4&#39;, &#39;CD8&#39;], decision_value:[1, -1])
    ├── naive (counter:0, decision_name:[&#39;CCR7&#39;, &#39;CD45RA&#39;], decision_value:[1, 1])
    ├── Tcm (counter:0, decision_name:[&#39;CCR7&#39;, &#39;CD45RA&#39;], decision_value:[1, -1])
    ├── Temra (counter:0, decision_name:[&#39;CCR7&#39;, &#39;CD45RA&#39;], decision_value:[-1, 1])
    └── Tem (counter:0, decision_name:[&#39;CCR7&#39;, &#39;CD45RA&#39;], decision_value:[-1, -1])
</pre></div></div>
</div>
<p>Let’s predict the cell type of all cells which returns a list of 999 predicted nodes!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cell_preds</span> <span class="o">=</span> <span class="n">cell_tree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">cellmat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell_preds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0      (((NBNode(&#39;/AllCells/DP&#39;, counter=0, decision_...
1      (((NBNode(&#39;/AllCells/DP&#39;, counter=0, decision_...
2      (((NBNode(&#39;/AllCells/DP&#39;, counter=0, decision_...
3      (((NBNode(&#39;/AllCells/DP&#39;, counter=0, decision_...
4      (((NBNode(&#39;/AllCells/DP&#39;, counter=0, decision_...
                             ...
994    (((NBNode(&#39;/AllCells/DP&#39;, counter=0, decision_...
995    (((NBNode(&#39;/AllCells/DP&#39;, counter=0, decision_...
996    (((NBNode(&#39;/AllCells/DP&#39;, counter=0, decision_...
997    (((NBNode(&#39;/AllCells/DP&#39;, counter=0, decision_...
998    (((NBNode(&#39;/AllCells/DP&#39;, counter=0, decision_...
Length: 999, dtype: object
</pre></div></div>
</div>
<p>This by itself did not change anything in the tree.</p>
<p>I will introduce another NBNode attribute: <code class="docutils literal notranslate"><span class="pre">NBNode.ids</span></code>. This is a list of numerical indices indicating which <em>predicted</em> nodes are “contained” in a specific node. Naturally, <code class="docutils literal notranslate"><span class="pre">root.ids</span></code> should contain <em>ALL</em> ids, and every other node only the list of ids which are (or passed) the node until reaching a endnode.</p>
<p>Even after predicting, no ids are set, so this is still an empty list.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cell_tree</span><span class="o">.</span><span class="n">ids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell_tree</span><span class="p">[</span><span class="s2">&quot;/AllCells/DP&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ids</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[]
[]
</pre></div></div>
</div>
<p>To set the ids, you have to actively use the predicted nodes and identify their ids. <code class="docutils literal notranslate"><span class="pre">celltree.id_preds</span></code> takes a list of nodes and sorts them within the tree. The numerical index refers to the order in which the predicted nodes occurred!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cell_tree</span><span class="o">.</span><span class="n">id_preds</span><span class="p">(</span><span class="n">cell_preds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell_tree</span><span class="o">.</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cell_tree</span><span class="o">.</span><span class="n">ids</span><span class="p">))</span>

<span class="c1"># With this here we see that nodes [69, 74, 443, 972, 973] are all in /AllCells/CD4-/CD8+</span>
<span class="c1"># or a node below!</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell_tree</span><span class="p">[</span><span class="s2">&quot;/AllCells/CD4-/CD8+&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell_tree</span><span class="p">[</span><span class="s2">&quot;/AllCells/CD4-/CD8+&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
999
[69, 74, 443, 972, 973]
[69, 74, 443, 972, 973]
</pre></div></div>
</div>
<p>However, it would be interesting to know how many cells are in each node. For this, we can use <code class="docutils literal notranslate"><span class="pre">cell_preds.count(cell_preds)</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cell_tree</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">cell_preds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>If we already set <code class="docutils literal notranslate"><span class="pre">NBNode.ids</span></code>, we could also not recount but directly use the <code class="docutils literal notranslate"><span class="pre">len(every_node.ids)</span></code> which saves us a lot of computation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cell_tree</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">cell_preds</span><span class="p">,</span> <span class="n">use_ids</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Internally, this iterates over every predicted node and iterates the tree until reaching the node. Any passed node’s <code class="docutils literal notranslate"><span class="pre">node.ids</span></code> gets appended by the (numerical) index of the predicted node.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cell_tree</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AllCells (counter:999)
├── DN (counter:0)
├── DP (counter:973)
├── CD4-/CD8+ (counter:5)
│   ├── naive (counter:5)
│   ├── Tcm (counter:0)
│   ├── Temra (counter:0)
│   └── Tem (counter:0)
└── CD4+/CD8- (counter:21)
    ├── naive (counter:20)
    ├── Tcm (counter:0)
    ├── Temra (counter:1)
    └── Tem (counter:0)
</pre></div></div>
</div>
<p>We see that now the printed <code class="docutils literal notranslate"><span class="pre">counter</span></code> became filled, and the majority of cells are <code class="docutils literal notranslate"><span class="pre">/AllCells/DP</span></code> (which are double positive T-cells, but that does not matter for our examples).</p>
<p>Finally, we can export the counts per node, but we should set <code class="docutils literal notranslate"><span class="pre">.data</span></code> for it, see another jupyter notebook for further explanation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cell_tree</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">cellmat</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Counts for every sample, only leaf (=end) nodes:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell_tree</span><span class="o">.</span><span class="n">export_counts</span><span class="p">(</span><span class="n">only_leafnodes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Counts for every sample, leaf AND intermediate nodes:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell_tree</span><span class="o">.</span><span class="n">export_counts</span><span class="p">(</span><span class="n">only_leafnodes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Counts for every sample, only leaf (=end) nodes:
Sample                       0
/AllCells/DN                 0
/AllCells/DP               973
/AllCells/CD4-/CD8+/naive    5
/AllCells/CD4-/CD8+/Tcm      0
/AllCells/CD4-/CD8+/Temra    0
/AllCells/CD4-/CD8+/Tem      0
/AllCells/CD4+/CD8-/naive   20
/AllCells/CD4+/CD8-/Tcm      0
/AllCells/CD4+/CD8-/Temra    1
/AllCells/CD4+/CD8-/Tem      0


Counts for every sample, leaf AND intermediate nodes:
Sample                       0
/AllCells/DN                 0
/AllCells/DP               973
/AllCells/CD4-/CD8+/naive    5
/AllCells/CD4-/CD8+/Tcm      0
/AllCells/CD4-/CD8+/Temra    0
/AllCells/CD4-/CD8+/Tem      0
/AllCells/CD4-/CD8+          5
/AllCells/CD4+/CD8-/naive   20
/AllCells/CD4+/CD8-/Tcm      0
/AllCells/CD4+/CD8-/Temra    1
/AllCells/CD4+/CD8-/Tem      0
/AllCells/CD4+/CD8-         21
/AllCells                  999
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/gugl/.conda_envs/nbnode_pyscaffold/lib/python3.8/site-packages/nbnode/nbnode.py:353: UserWarning: self.ids was an empty list, subset an empty dataframe. Did you call celltree.id_preds(predicted_nodes)? Can also be a node with no cells.
  warnings.warn(
/home/gugl/.conda_envs/nbnode_pyscaffold/lib/python3.8/site-packages/nbnode/nbnode.py:353: UserWarning: self.ids was an empty list, subset an empty dataframe. Did you call celltree.id_preds(predicted_nodes)? Can also be a node with no cells.
  warnings.warn(
/home/gugl/.conda_envs/nbnode_pyscaffold/lib/python3.8/site-packages/nbnode/nbnode.py:353: UserWarning: self.ids was an empty list, subset an empty dataframe. Did you call celltree.id_preds(predicted_nodes)? Can also be a node with no cells.
  warnings.warn(
/home/gugl/.conda_envs/nbnode_pyscaffold/lib/python3.8/site-packages/nbnode/nbnode.py:353: UserWarning: self.ids was an empty list, subset an empty dataframe. Did you call celltree.id_preds(predicted_nodes)? Can also be a node with no cells.
  warnings.warn(
/home/gugl/.conda_envs/nbnode_pyscaffold/lib/python3.8/site-packages/nbnode/nbnode.py:353: UserWarning: self.ids was an empty list, subset an empty dataframe. Did you call celltree.id_preds(predicted_nodes)? Can also be a node with no cells.
  warnings.warn(
/home/gugl/.conda_envs/nbnode_pyscaffold/lib/python3.8/site-packages/nbnode/nbnode.py:353: UserWarning: self.ids was an empty list, subset an empty dataframe. Did you call celltree.id_preds(predicted_nodes)? Can also be a node with no cells.
  warnings.warn(
/home/gugl/.conda_envs/nbnode_pyscaffold/lib/python3.8/site-packages/nbnode/nbnode.py:353: UserWarning: self.ids was an empty list, subset an empty dataframe. Did you call celltree.id_preds(predicted_nodes)? Can also be a node with no cells.
  warnings.warn(
/home/gugl/.conda_envs/nbnode_pyscaffold/lib/python3.8/site-packages/nbnode/nbnode.py:353: UserWarning: self.ids was an empty list, subset an empty dataframe. Did you call celltree.id_preds(predicted_nodes)? Can also be a node with no cells.
  warnings.warn(
/home/gugl/.conda_envs/nbnode_pyscaffold/lib/python3.8/site-packages/nbnode/nbnode.py:353: UserWarning: self.ids was an empty list, subset an empty dataframe. Did you call celltree.id_preds(predicted_nodes)? Can also be a node with no cells.
  warnings.warn(
/home/gugl/.conda_envs/nbnode_pyscaffold/lib/python3.8/site-packages/nbnode/nbnode.py:353: UserWarning: self.ids was an empty list, subset an empty dataframe. Did you call celltree.id_preds(predicted_nodes)? Can also be a node with no cells.
  warnings.warn(
/home/gugl/.conda_envs/nbnode_pyscaffold/lib/python3.8/site-packages/nbnode/nbnode.py:353: UserWarning: self.ids was an empty list, subset an empty dataframe. Did you call celltree.id_preds(predicted_nodes)? Can also be a node with no cells.
  warnings.warn(
/home/gugl/.conda_envs/nbnode_pyscaffold/lib/python3.8/site-packages/nbnode/nbnode.py:353: UserWarning: self.ids was an empty list, subset an empty dataframe. Did you call celltree.id_preds(predicted_nodes)? Can also be a node with no cells.
  warnings.warn(
</pre></div></div>
</div>
</section>
<section id="Math-on-one-NBNode">
<h2>Math on one NBNode<a class="headerlink" href="#Math-on-one-NBNode" title="Permalink to this heading">¶</a></h2>
<p>After we now have a usefull number assigned to each node, we can do quite a bit of math. Each <code class="docutils literal notranslate"><span class="pre">NBNode</span></code> has a <code class="docutils literal notranslate"><span class="pre">math_node_attribute</span></code> which is used to calculate math on. This is usually set to <code class="docutils literal notranslate"><span class="pre">counter</span></code>.</p>
<p>We can then use usual math to add, subtract, multiply, etc. nodes with numerics.</p>
<p>Note that this is then not backed up by <code class="docutils literal notranslate"><span class="pre">NBNode.ids</span></code> anymore!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Math operations do not happen inplace</span>
<span class="n">added_tree</span> <span class="o">=</span> <span class="n">cell_tree</span> <span class="o">+</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="n">added_tree</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="n">cell_tree</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AllCells (counter:1099)
├── DN (counter:100)
├── DP (counter:1073)
├── CD4-/CD8+ (counter:105)
│   ├── naive (counter:105)
│   ├── Tcm (counter:100)
│   ├── Temra (counter:100)
│   └── Tem (counter:100)
└── CD4+/CD8- (counter:121)
    ├── naive (counter:120)
    ├── Tcm (counter:100)
    ├── Temra (counter:101)
    └── Tem (counter:100)
None
AllCells (counter:999)
├── DN (counter:0)
├── DP (counter:973)
├── CD4-/CD8+ (counter:5)
│   ├── naive (counter:5)
│   ├── Tcm (counter:0)
│   ├── Temra (counter:0)
│   └── Tem (counter:0)
└── CD4+/CD8- (counter:21)
    ├── naive (counter:20)
    ├── Tcm (counter:0)
    ├── Temra (counter:1)
    └── Tem (counter:0)
None
</pre></div></div>
</div>
<p>Re-counting by using the ids RESETS all math operations and overwrites the counter with the length of the ids!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">added_tree</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">use_ids</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">added_tree</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AllCells (counter:999)
├── DN (counter:0)
├── DP (counter:973)
├── CD4-/CD8+ (counter:5)
│   ├── naive (counter:5)
│   ├── Tcm (counter:0)
│   ├── Temra (counter:0)
│   └── Tem (counter:0)
└── CD4+/CD8- (counter:21)
    ├── naive (counter:20)
    ├── Tcm (counter:0)
    ├── Temra (counter:1)
    └── Tem (counter:0)
</pre></div></div>
</div>
<p>To focus on the important math, we will only print the root node from now on, but could use pretty_print() everytime to show that the operations happen on every node.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_tree</span> <span class="o">=</span> <span class="n">cell_tree</span> <span class="o">+</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_tree</span><span class="p">)</span>

<span class="n">new_tree</span> <span class="o">=</span> <span class="n">new_tree</span> <span class="o">-</span> <span class="mi">10</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_tree</span><span class="p">)</span>

<span class="n">new_tree</span> <span class="o">=</span> <span class="n">new_tree</span> <span class="o">*</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_tree</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
NBNode(&#39;/AllCells&#39;, counter=1099, decision_name=None, decision_value=None)
NBNode(&#39;/AllCells&#39;, counter=1089, decision_name=None, decision_value=None)
NBNode(&#39;/AllCells&#39;, counter=2178, decision_name=None, decision_value=None)
</pre></div></div>
</div>
<p>Sometimes it is important which type is used. There are two options to do that:</p>
<ol class="arabic simple">
<li><p>Change the math operation such that it is appropriate</p></li>
<li><p>Modify the type of the tree</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">new_tree</span> <span class="o">=</span> <span class="n">new_tree</span> <span class="o">/</span><span class="mi">3</span>
<span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TypeError: descriptor &#39;__truediv__&#39; requires a &#39;float&#39; object but received a &#39;int&#39;&quot;</span><span class="p">)</span>

<span class="n">new_tree</span> <span class="o">=</span> <span class="n">new_tree</span> <span class="o">/</span><span class="mf">3.0</span>
<span class="c1"># Note that the error did NOT happen in the rootnode, so it might be that some math</span>
<span class="c1"># operations have already been done!</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_tree</span><span class="p">)</span>

<span class="c1"># With astype_math_node_attribute we can change the type of the math node attribute</span>
<span class="c1"># from all nodes in the tree</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_tree</span><span class="o">.</span><span class="n">astype_math_node_attribute</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_tree</span><span class="o">.</span><span class="n">astype_math_node_attribute</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
NBNode(&#39;/AllCells&#39;, counter=242.0, decision_name=None, decision_value=None)
NBNode(&#39;/AllCells&#39;, counter=242.0, decision_name=None, decision_value=None)
NBNode(&#39;/AllCells&#39;, counter=242, decision_name=None, decision_value=None)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">new_tree</span> <span class="o">/</span> <span class="mi">15</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_tree</span> <span class="o">//</span> <span class="mi">15</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_tree</span> <span class="o">%</span> <span class="mi">15</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_tree</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_tree</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
NBNode(&#39;/AllCells&#39;, counter=16.133333333333333, decision_name=None, decision_value=None)
NBNode(&#39;/AllCells&#39;, counter=16, decision_name=None, decision_value=None)
NBNode(&#39;/AllCells&#39;, counter=2, decision_name=None, decision_value=None)
NBNode(&#39;/AllCells&#39;, counter=968, decision_name=None, decision_value=None)
NBNode(&#39;/AllCells&#39;, counter=60, decision_name=None, decision_value=None)
</pre></div></div>
</div>
<section id="Equalities">
<h3>Equalities<a class="headerlink" href="#Equalities" title="Permalink to this heading">¶</a></h3>
<p>When introducing counters, suddenly the same “trees” are not identical anymore:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cell_tree</span> <span class="o">==</span> <span class="n">cell_tree</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell_tree</span> <span class="o">==</span> <span class="n">cell_tree</span> <span class="o">+</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
False
</pre></div></div>
</div>
<p>Therefore we introduce the difference between “structural” and “complete” identity. Two trees are structurally equal if their node.name, node.decision_name and node.decision_value are equal, everything else can be different.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nbnode.nbnode</span> <span class="kn">import</span> <span class="n">NBNode</span>
<span class="kn">import</span> <span class="nn">nbnode.nbnode_trees</span> <span class="k">as</span> <span class="nn">nbtree</span>

<span class="n">original_tree</span> <span class="o">=</span> <span class="n">nbtree</span><span class="o">.</span><span class="n">tree_simple</span><span class="p">()</span>
<span class="n">new_tree</span> <span class="o">=</span> <span class="n">nbtree</span><span class="o">.</span><span class="n">tree_simple</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_tree</span> <span class="o">==</span> <span class="n">new_tree</span>  <span class="o">+</span> <span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_tree</span><span class="o">.</span><span class="n">eq_structure</span><span class="p">(</span><span class="n">new_tree</span> <span class="o">+</span> <span class="mi">100</span><span class="p">))</span>

<span class="n">NBNode</span><span class="p">(</span><span class="s2">&quot;ADDITIONAL_NODE&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">new_tree</span><span class="p">)</span>

<span class="n">new_tree</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
<span class="n">original_tree</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">original_tree</span> <span class="o">==</span> <span class="n">original_tree</span> <span class="o">+</span> <span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">original_tree</span> <span class="o">==</span> <span class="n">new_tree</span><span class="p">)</span>

<span class="c1"># You can generate a new tree by only copying the structure, then counts and data are not copied:</span>
<span class="n">new_tree</span> <span class="o">=</span> <span class="n">original_tree</span><span class="o">.</span><span class="n">copy_structure</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
False
True
a (counter:0)
├── a0 (counter:0)
├── a1 (counter:0)
│   └── a1a (counter:0)
├── a2 (counter:0)
└── ADDITIONAL_NODE (counter:0)
a (counter:0)
├── a0 (counter:0)
├── a1 (counter:0)
│   └── a1a (counter:0)
└── a2 (counter:0)
False
False
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/gugl/.conda_envs/nbnode_pyscaffold/lib/python3.8/site-packages/nbnode/nbnode.py:364: UserWarning: data is no pandas.DataFrame, converting it via pd.DataFrame(data).
  warnings.warn(
</pre></div></div>
</div>
</section>
</section>
<section id="Math-with-multiple-NBNodes">
<h2>Math with multiple NBNodes<a class="headerlink" href="#Math-with-multiple-NBNodes" title="Permalink to this heading">¶</a></h2>
<p>We can then use usual math to add, subtract, multiply, etc. nodes with each other. Explicitely, this traverses all nodes in both trees simultaneously and does the mathematical operation using both <code class="docutils literal notranslate"><span class="pre">math_node_attribute</span></code>. The result is then saved in the <code class="docutils literal notranslate"><span class="pre">math_node_attribute</span></code>, but no tree is changed inplace.</p>
<p>Note that this is then not backed up by <code class="docutils literal notranslate"><span class="pre">NBNode.ids</span></code> anymore!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">nbnode.nbnode_trees</span> <span class="k">as</span> <span class="nn">nbtree</span>
<span class="n">cell_tree</span> <span class="o">=</span> <span class="n">nbtree</span><span class="o">.</span><span class="n">tree_complete_aligned_trunk</span><span class="p">()</span>
<span class="n">cell_tree</span><span class="o">.</span><span class="n">id_preds</span><span class="p">(</span><span class="n">cell_tree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">cellmat</span><span class="p">))</span>
<span class="n">cell_tree</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">use_ids</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cell_tree</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>

<span class="n">cell_tree_2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">cell_tree</span><span class="p">)</span>
<span class="c1"># Reset the counts of the nodes</span>
<span class="n">cell_tree_2</span><span class="o">.</span><span class="n">reset_counts</span><span class="p">()</span>
<span class="n">cell_tree_2</span> <span class="o">=</span> <span class="n">cell_tree_2</span> <span class="o">+</span> <span class="mi">1</span>

<span class="c1"># You can set the counter values manually.</span>
<span class="c1"># Keep in mind that setting an intermediate node (like this one)</span>
<span class="c1">#  might not make any sense biologically as every cell must reach a leaf node</span>
<span class="n">cell_tree_2</span><span class="p">[</span><span class="s2">&quot;/AllCells/CD4-/CD8+&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">counter</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">cell_tree_2</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AllCells (counter:999)
├── DN (counter:0)
├── DP (counter:973)
├── CD4-/CD8+ (counter:5)
│   ├── naive (counter:5)
│   ├── Tcm (counter:0)
│   ├── Temra (counter:0)
│   └── Tem (counter:0)
└── CD4+/CD8- (counter:21)
    ├── naive (counter:20)
    ├── Tcm (counter:0)
    ├── Temra (counter:1)
    └── Tem (counter:0)
AllCells (counter:1)
├── DN (counter:1)
├── DP (counter:1)
├── CD4-/CD8+ (counter:1000)
│   ├── naive (counter:1)
│   ├── Tcm (counter:1)
│   ├── Temra (counter:1)
│   └── Tem (counter:1)
└── CD4+/CD8- (counter:1)
    ├── naive (counter:1)
    ├── Tcm (counter:1)
    ├── Temra (counter:1)
    └── Tem (counter:1)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add the two trees</span>
<span class="p">(</span><span class="n">cell_tree</span> <span class="o">+</span> <span class="n">cell_tree_2</span><span class="p">)</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell_tree</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell_tree_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AllCells (counter:1000)
├── DN (counter:1)
├── DP (counter:974)
├── CD4-/CD8+ (counter:1005)
│   ├── naive (counter:6)
│   ├── Tcm (counter:1)
│   ├── Temra (counter:1)
│   └── Tem (counter:1)
└── CD4+/CD8- (counter:22)
    ├── naive (counter:21)
    ├── Tcm (counter:1)
    ├── Temra (counter:2)
    └── Tem (counter:1)
NBNode(&#39;/AllCells&#39;, counter=999, decision_name=None, decision_value=None)
NBNode(&#39;/AllCells&#39;, counter=1, decision_name=None, decision_value=None)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">cell_tree</span> <span class="o">-</span> <span class="n">cell_tree_2</span><span class="p">)</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AllCells (counter:998)
├── DN (counter:-1)
├── DP (counter:972)
├── CD4-/CD8+ (counter:-995)
│   ├── naive (counter:4)
│   ├── Tcm (counter:-1)
│   ├── Temra (counter:-1)
│   └── Tem (counter:-1)
└── CD4+/CD8- (counter:20)
    ├── naive (counter:19)
    ├── Tcm (counter:-1)
    ├── Temra (counter:0)
    └── Tem (counter:-1)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">cell_tree</span> <span class="o">*</span> <span class="n">cell_tree_2</span><span class="p">)</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AllCells (counter:999)
├── DN (counter:0)
├── DP (counter:973)
├── CD4-/CD8+ (counter:5000)
│   ├── naive (counter:5)
│   ├── Tcm (counter:0)
│   ├── Temra (counter:0)
│   └── Tem (counter:0)
└── CD4+/CD8- (counter:21)
    ├── naive (counter:20)
    ├── Tcm (counter:0)
    ├── Temra (counter:1)
    └── Tem (counter:0)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="p">(</span><span class="n">cell_tree</span> <span class="o">/</span> <span class="n">cell_tree_2</span><span class="p">)</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AllCells (counter:999.0)
├── DN (counter:0.0)
├── DP (counter:973.0)
├── CD4-/CD8+ (counter:0.005)
│   ├── naive (counter:5.0)
│   ├── Tcm (counter:0.0)
│   ├── Temra (counter:0.0)
│   └── Tem (counter:0.0)
└── CD4+/CD8- (counter:21.0)
    ├── naive (counter:20.0)
    ├── Tcm (counter:0.0)
    ├── Temra (counter:1.0)
    └── Tem (counter:0.0)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="p">(</span><span class="n">cell_tree</span> <span class="o">%</span> <span class="n">cell_tree_2</span><span class="p">)</span><span class="o">.</span><span class="n">pretty_print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
AllCells (counter:0)
├── DN (counter:0)
├── DP (counter:0)
├── CD4-/CD8+ (counter:5)
│   ├── naive (counter:0)
│   ├── Tcm (counter:0)
│   ├── Temra (counter:0)
│   └── Tem (counter:0)
└── CD4+/CD8- (counter:0)
    ├── naive (counter:0)
    ├── Tcm (counter:0)
    ├── Temra (counter:0)
    └── Tem (counter:0)
</pre></div></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">nbnode</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../readme.html">Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../notebooks.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="nbnode-01.html">Tutorial 1: NBNode basic,</a></li>
<li class="toctree-l2"><a class="reference internal" href="nbnode-02.html">Tutorial 2: Predictions I</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Tutorial 3: Counting and math</a></li>
<li class="toctree-l2"><a class="reference internal" href="nbnode-04.html">Tutorial 4: Predictions II, data, plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="nbnode-05_sim.html">Tutorial 5: Cytometry simulation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributions &amp; Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/modules.html">Module Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../notebooks.html">Tutorials</a><ul>
      <li>Previous: <a href="nbnode-02.html" title="previous chapter">Part predictions and unfitting data</a></li>
      <li>Next: <a href="nbnode-04.html" title="next chapter">Advanced predictions, data and plotting</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, gunthergl.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/notebooks/nbnode-03.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>